#!/usr/bin/env perl6
#u# http://rosettacode.org/wiki/Calculate_International_Securities_Identification_Number
#c# 2015-10-31 <RC
#m# MOAR: OK
#j#  JVM: OK


sub isin-checksum ( $isin --> Int ) {
    (10 - ([+] flat map {([+] .comb) % 10}, ([~] flat map {:36($_)}, $isin.comb).flip.comb «*» (2,1)) % 10) % 10
}

say "$_ -> {.&isin-checksum}" for
<
  US037833100
  US037383100
  SU037833100
  AU0000XVGZA
  AU0000VXGZA
  GB000263494
>;

use Test;
plan 2;
is ('US037833100'.&isin-checksum), '5', 'US037833100 -> 5';
is ('GB000263494'.&isin-checksum), '6', 'GB000263494 -> 6';
