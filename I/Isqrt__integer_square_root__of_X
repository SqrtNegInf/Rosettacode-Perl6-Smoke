#!/usr/bin/env raku
#u# http://rosettacode.org/wiki/Isqrt_(integer_square_root)_of_X
#c# 2020-12-09 <RC
#m# MOAR: OK
#j# JVM:  OK
#n# Quadratic residue algorithm 

my @res;

sub isqrt ( Int $x where * >= 0) {  my $X = $x; my ( $q, $r, $t ) = <1 0>; while $q <= $x { $q *= 4; }
    while  $q > 1 { $q /= 4; $t = $X - $r - $q; $r /= 2; if $t > 0 {$X = $t; $r += $q; } }
    $r
}

for 1..65 { print isqrt($_), " "; };

for 1, 3 ... 73 { @res.push: '7**' ~ $_ ~ ': ' ~ isqrt(7**$_) }

.say for @res;

#0 1 1 1 2 2 2 2 2 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 5 5 5 5 5 5 5 5 5 5 5 6 6 6 6 6 6 6 6 6 6 6 6 6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 8 
my $ref = q:to/END/;
7**1: 2
7**3: 18
7**5: 129
7**7: 907
7**9: 6352
7**11: 44467
7**13: 311269
7**15: 2178889
7**17: 15252229
7**19: 106765608
7**21: 747359260
7**23: 5231514822
7**25: 36620603758
7**27: 256344226312
7**29: 1794409584184
7**31: 12560867089291
7**33: 87926069625040
7**35: 615482487375282
7**37: 4308377411626977
7**39: 30158641881388842
7**41: 211110493169721897
7**43: 1477773452188053281
7**45: 10344414165316372973
7**47: 72410899157214610812
7**49: 506876294100502275687
7**51: 3548134058703515929815
7**53: 24836938410924611508707
7**55: 173858568876472280560953
7**57: 1217009982135305963926677
7**59: 8519069874947141747486745
7**61: 59633489124629992232407216
7**63: 417434423872409945626850517
7**65: 2922040967106869619387953625
7**67: 20454286769748087335715675381
7**69: 143180007388236611350009727669
7**71: 1002260051717656279450068093686
7**73: 7015820362023593956150476655802
END

use Test;
is @res.join("\n"), chomp $ref;
